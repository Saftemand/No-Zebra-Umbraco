tinymce.PluginManager.add("noneditable",function(n){function i(n){var t;return n.nodeType===1&&((t=n.getAttribute(f),t&&t!=="inherit")||(t=n.contentEditable,t!=="inherit"))?t:null}function u(n){for(var t;n;){if(t=i(n),t)return t==="false"?n:null;n=n.parentNode}}function c(){function l(n){while(n){if(n.id===s)return n;n=n.parentNode}}function a(n){var t;if(n)for(t=new o(n,n),n=t.current();n;n=t.next())if(n.nodeType===3)return n}function v(t,u){var e,o;if(i(t)==="false"&&f.isBlock(t)){r.select(t);return}return o=f.createRng(),i(t)==="true"&&(t.firstChild||t.appendChild(n.getDoc().createTextNode(" ")),t=t.firstChild,u=!0),e=f.create("span",{id:s,"data-mce-bogus":!0},h),u?t.parentNode.insertBefore(e,t):f.insertAfter(e,t),o.setStart(e.firstChild,1),o.collapse(!0),r.setRng(o),e}function c(n){var i,t,u;if(n)i=r.getRng(!0),i.setStartBefore(n),i.setEndBefore(n),t=a(n),t&&t.nodeValue.charAt(0)==h&&(t=t.deleteData(0,1)),f.remove(n,!0),r.setRng(i);else while((n=f.get(s))&&n!==u)t=a(n),t&&t.nodeValue.charAt(0)==h&&(t=t.deleteData(0,1)),f.remove(n,!0),u=n}function e(){function h(n,r){var u,f,h,e,s,c;if(u=t.startContainer,f=t.startOffset,u.nodeType==3){if(s=u.nodeValue.length,f>0&&f<s||(r?f==s:f===0))return}else if(f<u.childNodes.length)c=!r&&f>0?f-1:f,u=u.childNodes[c],u.hasChildNodes()&&(u=u.firstChild);else return r?null:n;for(h=new o(u,n);e=h[r?"prev":"next"]();){if(e.nodeType===3&&e.nodeValue.length>0)return;if(i(e)==="true")return e}return n}var n,f,s,t,e;c();s=r.isCollapsed();n=u(r.getStart());f=u(r.getEnd());(n||f)&&(t=r.getRng(!0),s?(n=n||f,(e=h(n,!0))?v(e,!0):(e=h(n,!1))?v(e,!1):r.select(n)):(t=r.getRng(!0),n&&t.setStartBefore(n),f&&t.setEndAfter(f),r.setRng(t)))}function y(s){function ft(n,t){while(n=n[t?"previousSibling":"nextSibling"])if(n.nodeType!==3||n.nodeValue.length>0)return n}function b(n,t){r.select(n);r.collapse(t)}function st(t){function a(n){for(var t=o;t;){if(t===n)return;t=t.parentNode}f.remove(n);e()}function v(){for(var r,e=n.schema.getNonEmptyElements(),f=new tinymce.dom.TreeWalker(o,n.getBody());r=t?f.prev():f.next();){if(e[r.nodeName.toLowerCase()])break;if(r.nodeType===3&&tinymce.trim(r.nodeValue).length>0)break;if(i(r)==="false")return a(r),!0}return u(r)?!0:!1}var h,o,s,c;if(r.isCollapsed()){if(h=r.getRng(!0),o=h.startContainer,s=h.startOffset,o=l(o)||o,c=u(o))return a(c),!1;if(o.nodeType==3&&(t?s>0:s<o.nodeValue.length))return!0;if(o.nodeType==1&&(o=o.childNodes[s]||o),v())return!1}return!0}var h=s.keyCode,a,w,nt,ut,p,k,d,it,et,ot,rt,g;e();nt=r.getStart();ut=r.getEnd();a=u(nt)||u(ut);var v=n.selection.getNode(),tt=h==t.LEFT||h==t.RIGHT||h==t.UP||h==t.DOWN,y=h==t.LEFT||h==t.UP;if(a&&(h<112||h>124)&&h!=t.DELETE&&h!=t.BACKSPACE){if((tinymce.isMac?s.metaKey:s.ctrlKey)&&(h==67||h==88||h==86))return;s.preventDefault();tt&&(n.dom.isBlock(a)?(p=y?a.previousSibling:a.nextSibling,(!p||p&&i(p)==="false")&&(k=f.create("p",null,"&nbsp;"),k.className="mceTmpParagraph",d=y?a:p,d&&d.parentNode?d.parentNode.insertBefore(k,d):p||y||a.parentNode.appendChild(k),p=k),it=new o(p,p),et=y?it.prev():it.next(),b(et,!y)):b(a,y))}else if(tt||h==t.BACKSPACE||h==t.DELETE){if(w=l(nt),w){if(h==t.LEFT||h==t.BACKSPACE)if(a=ft(w,!0),a&&i(a)==="false")if(s.preventDefault(),h==t.LEFT)b(a,!0);else{f.remove(a);return}else c(w);if(h==t.RIGHT||h==t.DELETE)if(a=ft(w,!0),a&&i(a)==="false")if(s.preventDefault(),h==t.RIGHT)b(a,!1);else{f.remove(a);return}else c(w)}else if(tt&&v&&v.className.indexOf("mceTmpParagraph")!==-1&&v[y?"previousSibling":"nextSibling"]&&(ot=v[y?"previousSibling":"nextSibling"],v.innerHTML==="&nbsp;"||v.innerHTML===""||v.innerHTML===" "?f.remove(v):v.className=v.className.replace("mceTmpParagraph",""),b(ot,!y)),rt=r.getRng(!0),g=rt.endContainer,f.isBlock(g)&&f.isBlock(g.nextSibling)&&rt.endOffset==1&&h==t.DELETE&&(a=u(g.nextSibling)),a&&(h==t.DELETE||h==t.BACKSPACE)&&f.isBlock(a)){s.preventDefault();f.remove(a);return}if((h==t.BACKSPACE||h==t.DELETE)&&!st(h==t.BACKSPACE))return s.preventDefault(),!1}}var f=n.dom,r=n.selection,s="mce_noneditablecaret",h="﻿";n.on("mousedown",function(t){var r=n.selection.getNode();r&&r.className.indexOf("mceTmpParagraph")!==-1&&r!==t.target&&(r.innerHTML==="&nbsp;"||r.innerHTML===""||r.innerHTML===" "?f.remove(r):r.className=r.className.replace("mceTmpParagraph",""));i(r)==="false"&&r==t.target&&e()});n.on("mouseup",e);n.on("keydown",y)}function l(t){var u=r.length,i=t.content,f=tinymce.trim(s);if(t.format!="raw"){while(u--)i=i.replace(r[u],function(t){var r=arguments,u=r[r.length-2];return u>0&&i.charAt(u-1)=='"'?t:'<span class="'+f+'" data-mce-content="'+n.dom.encode(r[0])+'">'+n.dom.encode(typeof r[1]=="string"?r[1]:r[0])+"<\/span>"});t.content=i}}var o=tinymce.dom.TreeWalker,e="contenteditable",f="data-mce-"+e,t=tinymce.util.VK,h,s,r;h=" "+tinymce.trim(n.getParam("noneditable_editable_class","mceEditable"))+" ";s=" "+tinymce.trim(n.getParam("noneditable_noneditable_class","mceNonEditable"))+" ";r=n.getParam("noneditable_regexp");r&&!r.length&&(r=[r]);n.on("PreInit",function(){if(c(),r)n.on("BeforeSetContent",l);n.parser.addAttributeFilter("class",function(n){for(var r=n.length,i,t;r--;)t=n[r],i=" "+t.attr("class")+" ",i.indexOf(h)!==-1?t.attr(f,"true"):i.indexOf(s)!==-1&&t.attr(f,"false")});n.serializer.addAttributeFilter(f,function(n){for(var i=n.length,t;i--;)t=n[i],r&&t.attr("data-mce-content")?(t.name="#text",t.type=3,t.raw=!0,t.value=t.attr("data-mce-content")):(t.attr(e,null),t.attr(f,null))});n.parser.addAttributeFilter(e,function(n){for(var i=n.length,t;i--;)t=n[i],t.attr(f,t.attr(e)),t.attr(e,null)})});n.on("drop",function(n){u(n.target)&&n.preventDefault()})});
//# sourceMappingURL=plugin.min.js.map
